---
title: "BigHornSheep"
author: "Julie Norman"
date: '2022-03-08'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data Upload

### Libraries

```{r}
library(tidyr)
library(tidyverse)
library(stringr)
library(mapview)
library(sf)
library(sp)
```

copy coordinates from pdf and save as .txt file. Delete all line breaks beforehand using find/replace function

```{r}
txt1 <- t(
  read.csv("/Users/julienorman/Documents/Economics/CGO\ Projects/CriticalHabitatMap/BHS_Unit1.txt", header = FALSE, sep = ";"))
txt1_df <- as.data.frame(txt1) # convert to df
txt1_df$Unit <- "1"

txt1A <- t(
  read.csv("/Users/julienorman/Documents/Economics/CGO\ Projects/CriticalHabitatMap/BHS_Unit1A-.txt", header = FALSE, sep = ";"))
txt1A_df <- as.data.frame(txt1A) 


txt2 <- t(
  read.csv("/Users/julienorman/Documents/Economics/CGO\ Projects/CriticalHabitatMap/BHS_Unit2.txt", header = FALSE, sep = ";"))
txt2_df <- as.data.frame(txt2) 
txt2_df$Unit <- "2"

txt3 <- t(
  read.csv("/Users/julienorman/Documents/Economics/CGO\ Projects/CriticalHabitatMap/BHS_Unit3.txt", header = FALSE, sep = ";"))
txt3_df <- as.data.frame(txt3) 
txt3_df$Unit <- "3"

txt4 <- t(
  read.csv("/Users/julienorman/Documents/Economics/CGO\ Projects/CriticalHabitatMap/BHS_Unit4.txt", header = FALSE, sep = ";"))
txt4_df <- as.data.frame(txt4) 
txt4_df$Unit <- "4"

txt5 <- t(
  read.csv("/Users/julienorman/Documents/Economics/CGO\ Projects/CriticalHabitatMap/BHS_Unit5.txt", header = FALSE, sep = ";"))
txt5_df <- as.data.frame(txt5) 
txt5_df$Unit <- "5"

txt6 <- t(
  read.csv("/Users/julienorman/Documents/Economics/CGO\ Projects/CriticalHabitatMap/BHS_Unit6.txt", header = FALSE, sep = ";"))
txt6_df <- as.data.frame(txt6) 
txt6_df$Unit <- "6"

txt7 <- t(
  read.csv("/Users/julienorman/Documents/Economics/CGO\ Projects/CriticalHabitatMap/BHS_Unit7.txt", header = FALSE, sep = ";"))
txt7_df <- as.data.frame(txt7) 
txt7_df$Unit <- "7"

txt8 <- t(
  read.csv("/Users/julienorman/Documents/Economics/CGO\ Projects/CriticalHabitatMap/BHS_Unit8.txt", header = FALSE, sep = ";"))
txt8_df <- as.data.frame(txt8) 
txt8_df$Unit <- "8"

txt9 <- t(
  read.csv("/Users/julienorman/Documents/Economics/CGO\ Projects/CriticalHabitatMap/BHS_Unit9.txt", header = FALSE, sep = ";"))
txt9_df <- as.data.frame(txt9) 
txt9_df$Unit <- "9"

txt10 <- t(
  read.csv("/Users/julienorman/Documents/Economics/CGO\ Projects/CriticalHabitatMap/BHS_Unit10.txt", header = FALSE, sep = ";"))
txt10_df <- as.data.frame(txt10) 
txt10_df$Unit <- "10"

txt11 <- t(
  read.csv("/Users/julienorman/Documents/Economics/CGO\ Projects/CriticalHabitatMap/BHS_Unit11.txt", header = FALSE, sep = ";"))
txt11_df <- as.data.frame(txt11) 
txt11_df$Unit <- "11"

```

Combine into one dataset
```{r}
cord_df <- rbind(txt1_df, txt2_df) %>% 
  rbind(txt3_df) %>% 
  rbind(txt4_df) %>% 
  rbind(txt5_df) %>% 
  rbind(txt6_df) %>% 
  rbind(txt7_df) %>% 
  rbind(txt8_df) %>% 
  rbind(txt9_df) %>% 
  rbind(txt10_df) %>% 
  rbind(txt11_df) 
```


Reformat data frame

```{r}
#flip orientation with and add column names
rownames(cord_df) <- NULL 

colnames(cord_df) <- c("Coordinates", "Unit") #name columns

cord_df <- cord_df %>% na.omit # delete empty rows


cord_df
```
## Create Shape Files

separate coordinates into latitude and longitude columns 

```{r}
cord_df <- separate(cord_df, "Coordinates", c("lat", "lon"), ",")


cord_df$lat <- as.numeric(cord_df$lat)
cord_df$lon <- as.numeric(cord_df$lon)
cord_df$Unit <- as.numeric(cord_df$Unit)

cord_df
```

Crs gathered based on GeodeticaDA and utmZone
https://spatialreference.org/ref/epsg/nad83-utm-zone-11n/ 




## Create Spacial file 

```{r}

# make a list
cord_list <- split(cord_df, cord_df$Unit)
# only want lon-lats in the list, not the names
cord_list <- lapply(cord_list, function(x) { x["Unit"] <- NULL; x })

#  make data.frame into spatial polygon, cf. http://jwhollister.com/iale_open_science/2015/07/05/03-Spatial-Data-In-R/

# create SpatialPolygons Object, convert coords to polygon
ps <- lapply(cord_list, Polygon)


# add Unit variable
p1 <- lapply(seq_along(ps), function(i) Polygons(list(ps[[i]]), 
                                            ID = names(cord_list)[i]  ))

bhs_sp <- SpatialPolygons(p1, proj4string = CRS("+proj=utm +zone=11 +ellps=GRS80 +datum=NAD83 +units=m +no_defs") )



bhs_spdf <- SpatialPolygonsDataFrame(bhs_sp, 
 data.frame(Unit = unique(cord_df$Unit), 
            row.names = unique(cord_df$Unit)))

bhs_sf <- st_as_sf(bhs_spdf, crs = "+proj=utm +zone=11 +ellps=GRS80 +datum=NAD83 +units=m +no_defs ")
```

```{r}
mapview(bhs_sf)
```


## Add removed areas

### Creating removed areas

```{r}
#flip orientation with and add column names

txt1A <- t(
  read.csv("/Users/julienorman/Documents/Economics/CGO\ Projects/CriticalHabitatMap/BHS_Unit1A-.txt", header = FALSE, sep = ";"))
txt1A_df <- as.data.frame(txt1A) 


rownames(txt1A_df) <- NULL 

colnames(txt1A_df) <- "Coordinates" #name columns

txt1A_df <- txt1A_df %>% na.omit # delete empty rows

txt1A_df <- separate(txt1A_df, "Coordinates", c("lat", "lon"), ",")


txt1A_df$lat <- as.numeric(txt1A_df$lat)
txt1A_df$lon <- as.numeric(txt1A_df$lon)


txt1A_df

A1_p <- Polygon(txt1A_df)
A1_p2 <- Polygons(list(A1_p),1)
A1_sp <- SpatialPolygons(list(A1_p2), proj4string = CRS("+proj=utm +zone=11 +ellps=GRS80 +datum=NAD83 +units=m +no_defs"))
plot(A1_sp)


A1_spdf <- SpatialPolygonsDataFrame(A1_sp,data)

spplot(spdf)

```

```{r}
unit1 <- filter(bhs_sf, Unit == 1)
```




